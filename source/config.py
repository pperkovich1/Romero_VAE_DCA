from torch import nn
import numpy as np

prev_model = "model.pt"
msa = "metaclust_processed_msa.fasta"

input_length = 7168
num_hidden = 400
num_latent = 20
activation_func = nn.Sigmoid()

max_epochs = 1000
convergence = 100



AMINO_ACIDS = np.array([aa for aa in "RKDEQNHSTCYWAILMFVPG-"], "S1")
# AAs = AMINO_ACIDS[:-1] # drop the gap character
AAs = AMINO_ACIDS # idk why Sameer dropped the gap character so I'm not doing that
AAs_string = AAs.tostring().decode("ascii")
AA_L = AAs.size # alphabet size
AA_map = {a:idx for idx,a in enumerate(AAs)} # map each amino acid to an index
# same map as above but with ascii indices
AA_map_str = {a:idx for idx, a in enumerate(AAs_string)}

example_seq = '''AGDFEKAKDAV-TNM--G-VG----W---N----L-----G-----N--------T----
L----D-A-----------------------------N----------------------
-----D--G---S--K--TW---------T------------------------------
------------------------------------------------------------
------------------------------------------------------------
-----------------------------------------------TT-E-Q-------
------------------------------------------------------------
------------------------------------------------------------
------------------------------------------------------------
------------------------------------------------------------
------------------------------------------------------------
------------------------------------------------------------
-------------------------------H--E---T--C-W-----------G--Q-
-----------P------V-T----------------------------------K---P
----E---L--------------------------M--K----M-----M-----A----
-----E----A--------G----------------------------------------
--------------F----N--T---I------R----------------------V---
-------------P----VT------------W---------------------------
------------------------------------------------------------
------------------------------------------------------------
-----------------------------Y--Q--EM-----------------------
---------------------------DA----------N---------G---------K
------------------------------------------------------------
----------------------------------------------------V---N---
--D-----------------------A----W----------------------------
------------------------------------------------------------
------------------------------------------------------------
-------------------------------------------------------M----
K------R----------V----------K---------------E--------V-----
--V-------D----------------------------------------Y---V----
--I------D---N----------------------------------------------
----------------G-------M--------Y----------------C---------
I-------------L----------------------------N-----V--------H-
-H--D-------------------------------------------------------
------------------------------------------------------------
------------------------------------------------------------
------------------------------------------------------------
------------------------------------------------------------
------------------------------------T--G---A-----DS--------N
T-F-K-------------------------------------------------------
-----------S-WL----------------------------K---A-----S-S----
-----------------------------K--N----Y------------------T---
------------------------------------------------------------
------------------------------------------------------------
---------------------------A-N--K---------------------------
-------------------------D---K---------Y--------------------
---------E----Y-----L-------W--------------------K-------Q--
--------I---------------------------------------------------
---------------A------E---------T---------------------------
--------------F---------------------------------------------
---------------------------------------------K--------D-----
---------------Y----------------------------------------D---
--D-----H---------------------------------------------------
------------------------------------------------------------
-----------L-----L-------------F--------E----A--------------
-------------------------------------------------------Y----
N----E-----------ML-----------------------------------------
------------------------------------------------------------
------------------------------------------------------------
------------------------------------------------------------
---------------DEK--------ST--------W-----------------------
--------------NE--P---V----------D------K-T--DG-------------
----------------------------------------------------------YK
-A----------------------------------------------------------
------------------------------------------------------------
------------------------------------------------------------
------------------------------------------------------------
---I---N----D---------------------------------Y-----A-------
-----------------K---------------------------------S--F---V-
------------------T---T-------------------V------R----------
---------NT----------------------------------------G--------
--G--N-------------N----------------------------------------
--------------------------------------K-----D------R--------
--N----L------I---V----------------N---T--------------Y--S--
ASS---------------------------------------------------------
----------------------------------------------------M-P--N--
A--M----K--N----L--------D----L-PEE------------------S-----N
H-----------------------------------------------------------
------------------------------------------------------------
------------------------------------------------------------
------------------------------------------------------------
------------------------------------------------------------
------------------------------------------------------------
------------------------------------------------------------
---------I-----I-----------F-----------Q------------I-------
H-----------------------------------------------------------
------------------------------------------------------------
-----S-----YP-----------------------------------------------
----NWQ-----------T-----------K--S-N------------------------
------------------------------------------------------------
------------------------------------------------------------
------------------------------------------------------------
----------------------------------------------------A-------
K--------K---E--------------------I-------------------------
------------------------------------------------------------
------------------------------------------------------------
------------------------------------------------------------
------------------------------------------------------------
------------------------------------------------------------
------------------------------------------------------------
------------------------------------------------------------
------------------------------------------------------------
------------------------------------------------------------
D----------N-L------I-------------------S-N-----------------
--I-------K-S-----------------N---------LL------------------
--N---------------------------------------------------------
------------------R-------AP---V------I------I--------G---E-
----------Y---A-----T-FTT-----------------------------------
------------------------------------------------------------
------------------------------------------------------------
------------------------------------------------------------
-----W--P-SDI------------D---YY-----------------N-----------
------------T--------------------------------------D-R----E-
--V--------A---------L---Y-----A----------M---D---Y---------
-------------L--I--Q-------------E--------------------------
-------------T---K----------------K-------------------------
------------------A----------G------------V-------------G---
T-------C------Y---------------W------M-----G----L----S--D--
-G-T--------------------Y----------------R--T-----L-----P--V
------F-H--Q-ADL-AQTLIKAYYGV'''
example_seq = example_seq.replace('\n','')
input_length = len(example_seq)
print(input_length)
